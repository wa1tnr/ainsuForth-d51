Script started on Wed 08 Aug 2018 04:55:35 AM UTC
ainsuForth-d51/doc/Log.d$ cd ..
ainsuForth-d51/doc$ export PS1=" $ "
 $ pwd
ainsuForth-d51/doc
 $ cd ..
 $ ls
 $ unzip clockey-atzip-now.zip 
Archive:  clockey-atzip-now.zip
replace hal/include/hpl_init.h? [y]es, [n]o, [A]ll, [N]one, [r]ename: A
  inflating: hal/include/hpl_init.h  
  inflating: include/component/ramecc.h  
  inflating: hri/hri_pcc_d51.h       
  inflating: CMSIS/Include/core_armv8mbl.h  
  inflating: hpl/pm/hpl_pm_base.h    
  inflating: include/samd51g18a.h    
  inflating: hal/utils/src/utils_syscalls.c  
  inflating: include/instance/adc1.h  
  inflating: include/instance/rstc.h  
  inflating: include/instance/dac.h  
  inflating: include/instance/tc4.h  
  inflating: include/component/cmcc.h  
  inflating: atmel_start_pins.h      
  inflating: examples/driver_examples.c  
  inflating: hal/utils/include/events.h  
  inflating: CMSIS/Include/core_cm7.h  
  inflating: include/component/dmac.h  
  inflating: hal/src/hal_timer.c     
  inflating: include/component/port.h  
  inflating: AtmelStart.gpdsc        
  inflating: include/instance/dmac.h  
  inflating: CMSIS/Include/core_cm33.h  
  inflating: hpl/systick/hpl_systick.c  
  inflating: CMSIS/Include/arm_const_structs.h  
  inflating: include/pio/samd51g19a.h  
  inflating: CMSIS/Include/core_sc300.h  
  inflating: hal/utils/include/utils_list.h  
  inflating: include/component/mclk.h  
  inflating: include/instance/can1.h  
  inflating: CMSIS/Include/core_cm23.h  
  inflating: hal/include/hpl_gpio.h  
  inflating: hri/hri_i2s_d51.h       
  inflating: include/component/aes.h  
  inflating: hri/hri_gclk_d51.h      
  inflating: config/hpl_mclk_config.h  
  inflating: include/component/nvmctrl.h  
  inflating: CMSIS/Include/cmsis_gcc.h  
  inflating: include/pio/samd51g18a.h  
  inflating: include/instance/qspi.h  
  inflating: hal/include/hpl_delay.h  
  inflating: include/instance/sdhc1.h  
  inflating: hal/include/hal_timer.h  
  inflating: hal/include/hpl_missing_features.h  
  inflating: hal/include/hpl_core.h  
  inflating: include/instance/cmcc.h  
  inflating: hri/hri_wdt_d51.h       
  inflating: include/component/icm.h  
  inflating: hal/src/hal_gpio.c      
  inflating: include/instance/sercom0.h  
  inflating: include/instance/ccl.h  
  inflating: include/samd51n20a.h    
  inflating: include/component/oscctrl.h  
  inflating: CMSIS/Include/core_sc000.h  
  inflating: include/instance/pdec.h  
  inflating: include/samd51j20a.h    
  inflating: include/instance/sercom2.h  
  inflating: config/hpl_osc32kctrl_config.h  
  inflating: hal/include/hpl_irq.h   
  inflating: include/instance/tc2.h  
  inflating: hal/include/hal_sleep.h  
  inflating: include/instance/port.h  
  inflating: include/component/can.h  
  inflating: include/instance/oscctrl.h  
  inflating: include/instance/can0.h  
  inflating: hal/include/hal_io.h    
  inflating: include/component/qspi.h  
  inflating: hal/utils/include/compiler.h  
  inflating: include/component/rstc.h  
  inflating: include/instance/adc0.h  
  inflating: CMSIS/Include/core_cm4.h  
  inflating: hal/utils/include/utils.h  
  inflating: include/pio/samd51j20a.h  
  inflating: include/instance/tc5.h  
  inflating: include/instance/hmatrix.h  
  inflating: hri/hri_eic_d51.h       
  inflating: include/instance/pm.h   
  inflating: CMSIS/Include/cmsis_compiler.h  
  inflating: CMSIS/Include/arm_common_tables.h  
  inflating: include/instance/tc6.h  
  inflating: hal/utils/include/utils_recursion_macro.h  
  inflating: include/component/gclk.h  
  inflating: hri/hri_pac_d51.h       
  inflating: hpl/dmac/hpl_dmac.c     
  inflating: CMSIS/Include/core_cm0.h  
  inflating: hal/utils/src/utils_list.c  
  inflating: include/instance/osc32kctrl.h  
  inflating: hri/hri_dsu_d51.h       
  inflating: hal/include/hpl_reset.h  
  inflating: include/instance/trng.h  
  inflating: include/instance/ramecc.h  
  inflating: include/instance/tcc4.h  
  inflating: include/instance/pcc.h  
  inflating: hri/hri_rstc_d51.h      
  inflating: hri/hri_port_d51.h      
  inflating: include/instance/nvmctrl.h  
  inflating: hpl/rtc/hpl_rtc_base.h  
  inflating: include/samd51j18a.h    
  inflating: include/samd51n19a.h    
  inflating: include/component/osc32kctrl.h  
  inflating: include/instance/sercom4.h  
  inflating: hri/hri_dmac_d51.h      
  inflating: include/component/ac.h  
  inflating: hri/hri_freqm_d51.h     
  inflating: hal/src/hal_io.c        
  inflating: include/instance/freqm.h  
  inflating: include/instance/sdhc0.h  
  inflating: driver_init.h           
  inflating: include/instance/sercom7.h  
  inflating: include/instance/sercom6.h  
  inflating: include/instance/pac.h  
  inflating: CMSIS/Include/core_cm3.h  
  inflating: include/component/sdhc.h  
  inflating: include/instance/sercom1.h  
  inflating: include/component/supc.h  
  inflating: hal/utils/src/utils_event.c  
  inflating: hal/utils/include/utils_event.h  
  inflating: hri/hri_sdhc_d51.h      
  inflating: CMSIS/Documentation/Core/html/index.html  
  inflating: include/component/rtc.h  
  inflating: hri/hri_evsys_d51.h     
  inflating: CMSIS/Include/core_cm0plus.h  
  inflating: include/pio/samd51n20a.h  
  inflating: include/pio/samd51j18a.h  
  inflating: hal/src/hal_atomic.c    
  inflating: include/component/tc.h  
  inflating: atmel_start.c           
  inflating: include/instance/sercom3.h  
  inflating: hal/include/hal_init.h  
  inflating: include/instance/pukcc.h  
  inflating: hal/utils/include/utils_assert.h  
  inflating: include/component/wdt.h  
  inflating: hal/include/hpl_calendar.h  
  inflating: hpl/tc/hpl_tc.c         
  inflating: hal/utils/include/err_codes.h  
  inflating: include/instance/tc3.h  
  inflating: driver_init.c           
  inflating: include/component/i2s.h  
  inflating: include/component/adc.h  
  inflating: hri/hri_icm_d51.h       
  inflating: CMSIS/Include/cmsis_armcc.h  
  inflating: hal/include/hpl_ramecc.h  
  inflating: hal/include/hpl_pwm.h   
  inflating: hpl/core/hpl_core_m4.c  
  inflating: include/instance/tc1.h  
  inflating: hal/include/hpl_timer.h  
  inflating: include/samd51p19a.h    
  inflating: hri/hri_usb_d51.h       
  inflating: include/instance/dsu.h  
  inflating: hpl/core/hpl_core_port.h  
  inflating: include/instance/mclk.h  
  inflating: hri/hri_hmatrixb_d51.h  
  inflating: include/instance/tcc3.h  
  inflating: include/instance/tc7.h  
  inflating: gcc/gcc/samd51j19a_sram.ld  
  inflating: include/instance/supc.h  
  inflating: gcc/gcc/samd51j19a_flash.ld  
  inflating: gcc/system_samd51.c     
  inflating: include/instance/tcc1.h  
  inflating: hri/hri_supc_d51.h      
  inflating: include/component-version.h  
  inflating: hpl/osc32kctrl/hpl_osc32kctrl.c  
  inflating: hal/src/hal_delay.c     
  inflating: include/pio/samd51n19a.h  
  inflating: hri/hri_adc_d51.h       
  inflating: hal/src/hal_init.c      
  inflating: include/component/tcc.h  
  inflating: hpl/pm/hpl_pm.c         
  inflating: hri/hri_sercom_d51.h    
  inflating: config/hpl_dmac_config.h  
  inflating: include/component/sercom.h  
  inflating: examples/driver_examples.h  
  inflating: hri/hri_d51.h           
  inflating: hri/hri_nvmctrl_d51.h   
  inflating: hpl/gclk/hpl_gclk_base.h  
  inflating: hpl/oscctrl/hpl_oscctrl.c  
  inflating: AtmelStart.env_conf     
  inflating: include/instance/tal.h  
  inflating: include/instance/evsys.h  
  inflating: CMSIS/Include/arm_math.h  
  inflating: include/component/pm.h  
  inflating: config/hpl_tc_config.h  
  inflating: hal/src/hal_sleep.c     
  inflating: hri/hri_trng_d51.h      
  inflating: armcc/Makefile          
  inflating: hri/hri_tcc_d51.h       
  inflating: include/pio/samd51p19a.h  
  inflating: hri/hri_aes_d51.h       
  inflating: hpl/core/hpl_init.c     
  inflating: include/instance/sercom5.h  
  inflating: hpl/gclk/hpl_gclk.c     
  inflating: include/component/dsu.h  
  inflating: hal/include/hal_atomic.h  
  inflating: include/component/freqm.h  
  inflating: hal/utils/include/utils_decrement_macro.h  
  inflating: hri/hri_pdec_d51.h      
  inflating: hri/hri_ccl_d51.h       
  inflating: include/instance/wdt.h  
  inflating: hal/include/hal_delay.h  
  inflating: hri/hri_qspi_d51.h      
  inflating: include/component/pac.h  
  inflating: include/instance/tc0.h  
  inflating: include/instance/eic.h  
  inflating: atmel_start_config.atstart  
  inflating: include/instance/gclk.h  
  inflating: include/instance/aes.h  
  inflating: hri/hri_rtc_d51.h       
  inflating: hpl/port/hpl_gpio_base.h  
  inflating: include/instance/ac.h   
  inflating: hpl/rtc/hpl_rtc.c       
  inflating: hal/include/hpl_dma.h   
  inflating: include/pio/samd51p20a.h  
  inflating: hri/hri_ramecc_d51.h    
  inflating: hri/hri_dac_d51.h       
  inflating: hpl/ramecc/hpl_ramecc.c  
  inflating: CMSIS/Include/cmsis_armclang.h  
  inflating: include/system_samd51.h  
  inflating: hri/hri_tc_d51.h        
  inflating: atmel_start.h           
  inflating: include/instance/tcc2.h  
  inflating: include/component/eic.h  
  inflating: include/instance/rtc.h  
  inflating: hal/include/hpl_time_measure.h  
  inflating: include/component/hmatrixb.h  
  inflating: include/instance/i2s.h  
  inflating: hal/utils/src/utils_assert.c  
  inflating: CMSIS/Include/core_armv8mml.h  
  inflating: include/component/evsys.h  
  inflating: include/sam.h           
  inflating: hal/utils/include/parts.h  
  inflating: include/instance/tcc0.h  
  inflating: hri/hri_pm_d51.h        
  inflating: include/samd51.h        
  inflating: hri/hri_oscctrl_d51.h   
  inflating: gcc/gcc/startup_samd51.c  
  inflating: include/pio/samd51j19a.h  
  inflating: hpl/mclk/hpl_mclk.c     
  inflating: hal/documentation/timer.rst  
  inflating: config/hpl_gclk_config.h  
  inflating: include/component/usb.h  
  inflating: hal/utils/include/utils_increment_macro.h  
  inflating: CMSIS/Include/tz_context.h  
  inflating: include/component/dac.h  
  inflating: include/instance/usb.h  
  inflating: include/samd51p20a.h    
  inflating: main.c                  
  inflating: include/component/pdec.h  
  inflating: config/hpl_oscctrl_config.h  
  inflating: include/samd51g19a.h    
  inflating: include/component/tal.h  
  inflating: gcc/Makefile            
  inflating: include/component/trng.h  
  inflating: config/peripheral_clk_config.h  
  inflating: hal/include/hpl_sleep.h  
  inflating: include/component/ccl.h  
  inflating: include/instance/icm.h  
  inflating: hri/hri_osc32kctrl_d51.h  
  inflating: include/component/pcc.h  
  inflating: hpl/tc/hpl_tc_base.h    
  inflating: hal/utils/include/utils_repeat_macro.h  
  inflating: hal/include/hal_gpio.h  
  inflating: hri/hri_ac_d51.h        
  inflating: hri/hri_mclk_d51.h      
  inflating: include/samd51j19a.h    
  inflating: hri/hri_cmcc_d51.h      
  inflating: config/hpl_systick_config.h  
 $ ls *zip
clockey-atzip-now.zip
 $ md5sum cruft.d/clockey-atzip-now.zip ../ainsuForth-d51/clockey-atzip-now.zip 
a5fb3045a854c9e2a9cc3486a94c11d0  ../ainsuForth-d51/clockey-atzip-now.zip

 $ md5sum ../ainsuForth-d51/0-Distrib.d/clockey-amrt-aa-8AUG18.atzip 
a5fb3045a854c9e2a9cc3486a94c11d0  ../ainsuForth-d51/0-Distrib.d/clockey-amrt-aa-8AUG18.atzip
 $ ls

 $ git diff --no-color | cat -n -
     1	diff --git a/AtmelStart.gpdsc b/AtmelStart.gpdsc
     2	index e6a6533..6c1ab8d 100644
     3	--- a/AtmelStart.gpdsc
     4	+++ b/AtmelStart.gpdsc
     5	@@ -42,7 +42,7 @@
     6	       <description>Atmel Start Framework</description>
     7	       <RTE_Components_h>#define ATMEL_START</RTE_Components_h>
     8	       <files>
     9	-        <file category="doc" condition="ARMCC, GCC, IAR" name="hal/documentation/usart_sync.rst"/>
    10	+        <file category="doc" condition="ARMCC, GCC, IAR" name="hal/documentation/timer.rst"/>
    11	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hal_atomic.h"/>
    12	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hal_delay.h"/>
    13	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hal_gpio.h"/>
    14	@@ -53,24 +53,11 @@
    15	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_delay.h"/>
    16	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_dma.h"/>
    17	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_gpio.h"/>
    18	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_i2c_m_async.h"/>
    19	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_i2c_m_sync.h"/>
    20	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_i2c_s_async.h"/>
    21	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_i2c_s_sync.h"/>
    22	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_init.h"/>
    23	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_irq.h"/>
    24	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_ramecc.h"/>
    25	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_sleep.h"/>
    26	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_spi.h"/>
    27	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_spi_async.h"/>
    28	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_spi_m_async.h"/>
    29	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_spi_m_dma.h"/>
    30	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_spi_m_sync.h"/>
    31	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_spi_s_async.h"/>
    32	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_spi_s_sync.h"/>
    33	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_spi_sync.h"/>
    34	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_time_measure.h"/>
    35	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_usart.h"/>
    36	         <file category="source" condition="ARMCC, GCC, IAR" name="hal/src/hal_atomic.c"/>
    37	         <file category="source" condition="ARMCC, GCC, IAR" name="hal/src/hal_delay.c"/>
    38	         <file category="source" condition="ARMCC, GCC, IAR" name="hal/src/hal_gpio.c"/>
    39	@@ -82,9 +69,11 @@
    40	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/utils/include/events.h"/>
    41	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/utils/include/utils.h"/>
    42	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/utils/include/utils_assert.h"/>
    43	+        <file category="header" condition="ARMCC, GCC, IAR" name="hal/utils/include/utils_decrement_macro.h"/>
    44	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/utils/include/utils_event.h"/>
    45	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/utils/include/utils_increment_macro.h"/>
    46	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/utils/include/utils_list.h"/>
    47	+        <file category="header" condition="ARMCC, GCC, IAR" name="hal/utils/include/utils_recursion_macro.h"/>
    48	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/utils/include/utils_repeat_macro.h"/>
    49	         <file category="source" condition="ARMCC, GCC, IAR" name="hal/utils/src/utils_assert.c"/>
    50	         <file category="source" condition="ARMCC, GCC, IAR" name="hal/utils/src/utils_event.c"/>
    51	@@ -133,12 +122,13 @@
    52	         <file category="header" condition="ARMCC, GCC, IAR" name="atmel_start_pins.h"/>
    53	         <file category="header" condition="ARMCC, GCC, IAR" name="examples/driver_examples.h"/>
    54	         <file category="source" condition="ARMCC, GCC, IAR" name="examples/driver_examples.c"/>
    55	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hal_usart_sync.h"/>
    56	+        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hal_timer.h"/>
    57	+        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_calendar.h"/>
    58	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_missing_features.h"/>
    59	+        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_pwm.h"/>
    60	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_reset.h"/>
    61	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_usart_async.h"/>
    62	-        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_usart_sync.h"/>
    63	-        <file category="source" condition="ARMCC, GCC, IAR" name="hal/src/hal_usart_sync.c"/>
    64	+        <file category="header" condition="ARMCC, GCC, IAR" name="hal/include/hpl_timer.h"/>
    65	+        <file category="source" condition="ARMCC, GCC, IAR" name="hal/src/hal_timer.c"/>
    66	         <file category="header" condition="ARMCC, GCC, IAR" name="hal/utils/include/parts.h"/>
    67	         <file category="source" condition="ARMCC, GCC, IAR" name="hpl/core/hpl_core_m4.c"/>
    68	         <file category="header" condition="ARMCC, GCC, IAR" name="hpl/core/hpl_core_port.h"/>
    69	@@ -153,8 +143,11 @@
    70	         <file category="header" condition="ARMCC, GCC, IAR" name="hpl/pm/hpl_pm_base.h"/>
    71	         <file category="header" condition="ARMCC, GCC, IAR" name="hpl/port/hpl_gpio_base.h"/>
    72	         <file category="source" condition="ARMCC, GCC, IAR" name="hpl/ramecc/hpl_ramecc.c"/>
    73	-        <file category="source" condition="ARMCC, GCC, IAR" name="hpl/sercom/hpl_sercom.c"/>
    74	+        <file category="source" condition="ARMCC, GCC, IAR" name="hpl/rtc/hpl_rtc.c"/>
    75	+        <file category="header" condition="ARMCC, GCC, IAR" name="hpl/rtc/hpl_rtc_base.h"/>
    76	         <file category="source" condition="ARMCC, GCC, IAR" name="hpl/systick/hpl_systick.c"/>
    77	+        <file category="source" condition="ARMCC, GCC, IAR" name="hpl/tc/hpl_tc.c"/>
    78	+        <file category="header" condition="ARMCC, GCC, IAR" name="hpl/tc/hpl_tc_base.h"/>
    79	         <file category="header" condition="ARMCC, GCC, IAR" name="atmel_start.h"/>
    80	         <file category="source" condition="ARMCC, GCC, IAR" name="atmel_start.c"/>
    81	         <file attr="config" category="header" condition="ARMCC, GCC, IAR" name="config/hpl_dmac_config.h"/>
    82	@@ -162,8 +155,9 @@
    83	         <file attr="config" category="header" condition="ARMCC, GCC, IAR" name="config/hpl_mclk_config.h"/>
    84	         <file attr="config" category="header" condition="ARMCC, GCC, IAR" name="config/hpl_osc32kctrl_config.h"/>
    85	         <file attr="config" category="header" condition="ARMCC, GCC, IAR" name="config/hpl_oscctrl_config.h"/>
    86	-        <file attr="config" category="header" condition="ARMCC, GCC, IAR" name="config/hpl_sercom_config.h"/>
    87	+        <file attr="config" category="header" condition="ARMCC, GCC, IAR" name="config/hpl_rtc_config.h"/>
    88	         <file attr="config" category="header" condition="ARMCC, GCC, IAR" name="config/hpl_systick_config.h"/>
    89	+        <file attr="config" category="header" condition="ARMCC, GCC, IAR" name="config/hpl_tc_config.h"/>
    90	         <file attr="config" category="header" condition="ARMCC, GCC, IAR" name="config/peripheral_clk_config.h"/>
    91	         <file category="include" condition="ARMCC, GCC, IAR" name=""/>
    92	         <file category="include" condition="ARMCC, GCC, IAR" name="config"/>
    93	@@ -179,8 +173,9 @@
    94	         <file category="include" condition="ARMCC, GCC, IAR" name="hpl/pm"/>
    95	         <file category="include" condition="ARMCC, GCC, IAR" name="hpl/port"/>
    96	         <file category="include" condition="ARMCC, GCC, IAR" name="hpl/ramecc"/>
    97	-        <file category="include" condition="ARMCC, GCC, IAR" name="hpl/sercom"/>
    98	+        <file category="include" condition="ARMCC, GCC, IAR" name="hpl/rtc"/>
    99	         <file category="include" condition="ARMCC, GCC, IAR" name="hpl/systick"/>
   100	+        <file category="include" condition="ARMCC, GCC, IAR" name="hpl/tc"/>
   101	         <file category="include" condition="ARMCC, GCC, IAR" name="hri"/>
   102	         <file category="include" condition="ARMCC, GCC, IAR" name=""/>
   103	       </files>
   104	diff --git a/armcc/Makefile b/armcc/Makefile
   105	index 311e3d9..646003f 100644
   106	--- a/armcc/Makefile
   107	+++ b/armcc/Makefile
   108	@@ -28,6 +28,7 @@ endif
   109	 SUB_DIRS +=  \
   110	  \
   111	 hpl/pm \
   112	+hpl/tc \
   113	 hpl/osc32kctrl \
   114	 hpl/ramecc \
   115	 hpl/dmac \
   116	@@ -35,10 +36,10 @@ hal/src \
   117	 hpl/mclk \
   118	 hpl/systick \
   119	 hal/utils/src \
   120	-hpl/sercom \
   121	 examples \
   122	 hpl/gclk \
   123	 hpl/oscctrl \
   124	+hpl/rtc \
   125	 hpl/core
   126	 
   127	 # List the object files
   128	@@ -46,54 +47,56 @@ OBJS +=  \
   129	 hal/src/hal_io.o \
   130	 hpl/systick/hpl_systick.o \
   131	 hpl/core/hpl_core_m4.o \
   132	+hal/src/hal_timer.o \
   133	 hal/src/hal_delay.o \
   134	 hpl/oscctrl/hpl_oscctrl.o \
   135	 hpl/core/hpl_init.o \
   136	-hpl/gclk/hpl_gclk.o \
   137	+hpl/ramecc/hpl_ramecc.o \
   138	 hal/utils/src/utils_list.o \
   139	 hal/utils/src/utils_assert.o \
   140	 hpl/dmac/hpl_dmac.o \
   141	 hpl/pm/hpl_pm.o \
   142	-hal/src/hal_usart_sync.o \
   143	 hpl/mclk/hpl_mclk.o \
   144	-hpl/ramecc/hpl_ramecc.o \
   145	+hpl/gclk/hpl_gclk.o \
   146	 hal/src/hal_init.o \
   147	 main.o \
   148	 hpl/osc32kctrl/hpl_osc32kctrl.o \
   149	+hpl/rtc/hpl_rtc.o \
   150	 examples/driver_examples.o \
   151	 driver_init.o \
   152	-hpl/sercom/hpl_sercom.o \
   153	 hal/src/hal_gpio.o \
   154	 hal/utils/src/utils_event.o \
   155	 hal/src/hal_sleep.o \
   156	 atmel_start.o \
   157	+hpl/tc/hpl_tc.o \
   158	 hal/src/hal_atomic.o
   159	 
   160	 OBJS_AS_ARGS +=  \
   161	 "hal/src/hal_io.o" \
   162	 "hpl/systick/hpl_systick.o" \
   163	 "hpl/core/hpl_core_m4.o" \
   164	+"hal/src/hal_timer.o" \
   165	 "hal/src/hal_delay.o" \
   166	 "hpl/oscctrl/hpl_oscctrl.o" \
   167	 "hpl/core/hpl_init.o" \
   168	-"hpl/gclk/hpl_gclk.o" \
   169	+"hpl/ramecc/hpl_ramecc.o" \
   170	 "hal/utils/src/utils_list.o" \
   171	 "hal/utils/src/utils_assert.o" \
   172	 "hpl/dmac/hpl_dmac.o" \
   173	 "hpl/pm/hpl_pm.o" \
   174	-"hal/src/hal_usart_sync.o" \
   175	 "hpl/mclk/hpl_mclk.o" \
   176	-"hpl/ramecc/hpl_ramecc.o" \
   177	+"hpl/gclk/hpl_gclk.o" \
   178	 "hal/src/hal_init.o" \
   179	 "main.o" \
   180	 "hpl/osc32kctrl/hpl_osc32kctrl.o" \
   181	+"hpl/rtc/hpl_rtc.o" \
   182	 "examples/driver_examples.o" \
   183	 "driver_init.o" \
   184	-"hpl/sercom/hpl_sercom.o" \
   185	 "hal/src/hal_gpio.o" \
   186	 "hal/utils/src/utils_event.o" \
   187	 "hal/src/hal_sleep.o" \
   188	 "atmel_start.o" \
   189	+"hpl/tc/hpl_tc.o" \
   190	 "hal/src/hal_atomic.o"
   191	 
   192	 # List the dependency files
   193	@@ -105,6 +108,7 @@ DEPS_AS_ARGS +=  \
   194	 "hpl/ramecc/hpl_ramecc.d" \
   195	 "hpl/systick/hpl_systick.d" \
   196	 "hpl/core/hpl_core_m4.d" \
   197	+"hal/src/hal_timer.d" \
   198	 "hal/utils/src/utils_list.d" \
   199	 "hpl/dmac/hpl_dmac.d" \
   200	 "hal/utils/src/utils_assert.d" \
   201	@@ -113,16 +117,16 @@ DEPS_AS_ARGS +=  \
   202	 "hpl/pm/hpl_pm.d" \
   203	 "hpl/gclk/hpl_gclk.d" \
   204	 "hal/src/hal_init.d" \
   205	-"hal/src/hal_usart_sync.d" \
   206	 "hpl/mclk/hpl_mclk.d" \
   207	 "driver_init.d" \
   208	 "hpl/osc32kctrl/hpl_osc32kctrl.d" \
   209	 "main.d" \
   210	 "examples/driver_examples.d" \
   211	+"hpl/rtc/hpl_rtc.d" \
   212	 "hal/src/hal_sleep.d" \
   213	-"hpl/sercom/hpl_sercom.d" \
   214	 "hal/src/hal_gpio.d" \
   215	 "hal/src/hal_atomic.d" \
   216	+"hpl/tc/hpl_tc.d" \
   217	 "hpl/oscctrl/hpl_oscctrl.d" \
   218	 "atmel_start.d"
   219	 
   220	@@ -160,7 +164,7 @@ $(OBJS_AS_ARGS)
   221	 	@echo Building file: $<
   222	 	@echo ARMCC Compiler
   223	 	$(QUOTE)armcc$(QUOTE) --c99 -c -DDEBUG -O1 -g --apcs=interwork --split_sections --cpu Cortex-M4 -D__SAMD51J19A__ \
   224	--I"../" -I"../config" -I"../examples" -I"../hal/include" -I"../hal/utils/include" -I"../hpl/core" -I"../hpl/dmac" -I"../hpl/gclk" -I"../hpl/mclk" -I"../hpl/osc32kctrl" -I"../hpl/oscctrl" -I"../hpl/pm" -I"../hpl/port" -I"../hpl/ramecc" -I"../hpl/sercom" -I"../hpl/systick" -I"../hri" -I"../" -I"../CMSIS/Include" -I"../include"  \
   225	+-I"../" -I"../config" -I"../examples" -I"../hal/include" -I"../hal/utils/include" -I"../hpl/core" -I"../hpl/dmac" -I"../hpl/gclk" -I"../hpl/mclk" -I"../hpl/osc32kctrl" -I"../hpl/oscctrl" -I"../hpl/pm" -I"../hpl/port" -I"../hpl/ramecc" -I"../hpl/rtc" -I"../hpl/systick" -I"../hpl/tc" -I"../hri" -I"../" -I"../CMSIS/Include" -I"../include"  \
   226	 --depend "$@"  -o "$@" "$<"
   227	 
   228	 	@echo Finished building: $<
   229	@@ -169,7 +173,7 @@ $(OBJS_AS_ARGS)
   230	 	@echo Building file: $<
   231	 	@echo ARMCC Assembler
   232	 	$(QUOTE)armasm$(QUOTE) -g --apcs=interwork --cpu Cortex-M4 --pd "D__SAMD51J19A__ SETA 1" \
   233	--I"../" -I"../config" -I"../examples" -I"../hal/include" -I"../hal/utils/include" -I"../hpl/core" -I"../hpl/dmac" -I"../hpl/gclk" -I"../hpl/mclk" -I"../hpl/osc32kctrl" -I"../hpl/oscctrl" -I"../hpl/pm" -I"../hpl/port" -I"../hpl/ramecc" -I"../hpl/sercom" -I"../hpl/systick" -I"../hri" -I"../" -I"../CMSIS/Include" -I"../include"  \
   234	+-I"../" -I"../config" -I"../examples" -I"../hal/include" -I"../hal/utils/include" -I"../hpl/core" -I"../hpl/dmac" -I"../hpl/gclk" -I"../hpl/mclk" -I"../hpl/osc32kctrl" -I"../hpl/oscctrl" -I"../hpl/pm" -I"../hpl/port" -I"../hpl/ramecc" -I"../hpl/rtc" -I"../hpl/systick" -I"../hpl/tc" -I"../hri" -I"../" -I"../CMSIS/Include" -I"../include"  \
   235	 --depend "$(@:%.o=%.d)" -o "$@" "$<"
   236	 
   237	 	@echo Finished building: $<
   238	@@ -178,7 +182,7 @@ $(OBJS_AS_ARGS)
   239	 	@echo Building file: $<
   240	 	@echo ARMCC Preprocessing Assembler
   241	 	$(QUOTE)armcc$(QUOTE) --c99 -c -DDEBUG -O1 -g --apcs=interwork --split_sections --cpu Cortex-M4 -D__SAMD51J19A__ \
   242	--I"../" -I"../config" -I"../examples" -I"../hal/include" -I"../hal/utils/include" -I"../hpl/core" -I"../hpl/dmac" -I"../hpl/gclk" -I"../hpl/mclk" -I"../hpl/osc32kctrl" -I"../hpl/oscctrl" -I"../hpl/pm" -I"../hpl/port" -I"../hpl/ramecc" -I"../hpl/sercom" -I"../hpl/systick" -I"../hri" -I"../" -I"../CMSIS/Include" -I"../include"  \
   243	+-I"../" -I"../config" -I"../examples" -I"../hal/include" -I"../hal/utils/include" -I"../hpl/core" -I"../hpl/dmac" -I"../hpl/gclk" -I"../hpl/mclk" -I"../hpl/osc32kctrl" -I"../hpl/oscctrl" -I"../hpl/pm" -I"../hpl/port" -I"../hpl/ramecc" -I"../hpl/rtc" -I"../hpl/systick" -I"../hpl/tc" -I"../hri" -I"../" -I"../CMSIS/Include" -I"../include"  \
   244	 --depend "$@"  -o "$@" "$<"
   245	 
   246	 	@echo Finished building: $<
   247	diff --git a/atmel_start_config.atstart b/atmel_start_config.atstart
   248	index bbf202c..0878843 100644
   249	--- a/atmel_start_config.atstart
   250	+++ b/atmel_start_config.atstart
   251	@@ -558,7 +558,7 @@ drivers:
   252	     api: HAL:HPL:GCLK
   253	     configuration:
   254	       enable_gclk_gen_0: true
   255	-      enable_gclk_gen_1: false
   256	+      enable_gclk_gen_1: true
   257	       enable_gclk_gen_10: false
   258	       enable_gclk_gen_11: false
   259	       enable_gclk_gen_2: false
   260	@@ -584,7 +584,7 @@ drivers:
   261	       gclk_arch_gen_11_oe: false
   262	       gclk_arch_gen_11_oov: false
   263	       gclk_arch_gen_11_runstdby: false
   264	-      gclk_arch_gen_1_enable: false
   265	+      gclk_arch_gen_1_enable: true
   266	       gclk_arch_gen_1_idc: false
   267	       gclk_arch_gen_1_oe: false
   268	       gclk_arch_gen_1_oov: false
   269	@@ -595,10 +595,10 @@ drivers:
   270	       gclk_arch_gen_2_oov: false
   271	       gclk_arch_gen_2_runstdby: false
   272	       gclk_arch_gen_3_enable: true
   273	-      gclk_arch_gen_3_idc: false
   274	+      gclk_arch_gen_3_idc: true
   275	       gclk_arch_gen_3_oe: true
   276	       gclk_arch_gen_3_oov: false
   277	-      gclk_arch_gen_3_runstdby: false
   278	+      gclk_arch_gen_3_runstdby: true
   279	       gclk_arch_gen_4_enable: false
   280	       gclk_arch_gen_4_idc: false
   281	       gclk_arch_gen_4_oe: false
   282	@@ -638,7 +638,7 @@ drivers:
   283	       gclk_gen_11_div: 1
   284	       gclk_gen_11_div_sel: false
   285	       gclk_gen_11_oscillator: External Crystal Oscillator 8-48MHz (XOSC1)
   286	-      gclk_gen_1_div: 1
   287	+      gclk_gen_1_div: 24
   288	       gclk_gen_1_div_sel: false
   289	       gclk_gen_1_oscillator: Digital Frequency Locked Loop (DFLL48M)
   290	       gclk_gen_2_div: 1
   291	@@ -646,7 +646,7 @@ drivers:
   292	       gclk_gen_2_oscillator: External Crystal Oscillator 8-48MHz (XOSC1)
   293	       gclk_gen_3_div: 1
   294	       gclk_gen_3_div_sel: false
   295	-      gclk_gen_3_oscillator: 32kHz Ultra Low Power Internal Oscillator (OSCULP32K)
   296	+      gclk_gen_3_oscillator: 32kHz External Crystal Oscillator (XOSC32K)
   297	       gclk_gen_4_div: 1
   298	       gclk_gen_4_div_sel: false
   299	       gclk_gen_4_oscillator: External Crystal Oscillator 8-48MHz (XOSC1)
   300	@@ -698,17 +698,17 @@ drivers:
   301	     configuration:
   302	       enable_osculp32k: true
   303	       enable_rtc_source: false
   304	-      enable_xosc32k: false
   305	+      enable_xosc32k: true
   306	       osculp32k_calib: 0
   307	       osculp32k_calib_enable: false
   308	       rtc_1khz_selection: false
   309	-      rtc_source_oscillator: 32kHz Ultra Low Power Internal Oscillator (OSCULP32K)
   310	+      rtc_source_oscillator: 32kHz External Crystal Oscillator (XOSC32K)
   311	       xosc32k_arch_cfden: false
   312	       xosc32k_arch_cfdeo: false
   313	       xosc32k_arch_cgm: Standard mode
   314	       xosc32k_arch_en1k: false
   315	       xosc32k_arch_en32k: false
   316	-      xosc32k_arch_enable: false
   317	+      xosc32k_arch_enable: true
   318	       xosc32k_arch_ondemand: true
   319	       xosc32k_arch_runstdby: false
   320	       xosc32k_arch_startup: 62592us
   321	@@ -735,8 +735,8 @@ drivers:
   322	       dfll_arch_llaw: false
   323	       dfll_arch_ondemand: false
   324	       dfll_arch_qldis: false
   325	-      dfll_arch_runstdby: false
   326	-      dfll_arch_stable: false
   327	+      dfll_arch_runstdby: true
   328	+      dfll_arch_stable: true
   329	       dfll_arch_usbcrm: true
   330	       dfll_arch_waitlock: true
   331	       dfll_mode: Open Loop Mode
   332	@@ -809,51 +809,38 @@ drivers:
   333	     variant: null
   334	     clocks:
   335	       domain_group: null
   336	-  USART_0a:
   337	-    user_label: USART_0a
   338	-    definition: Atmel:SAMD51_Drivers:0.0.1::SAMD51J19A-AF::SERCOM5::driver_config_definition::UART::HAL:Driver:USART.Sync
   339	-    functionality: USART
   340	-    api: HAL:Driver:USART_Sync
   341	+  TIMER_0:
   342	+    user_label: TIMER_0
   343	+    definition: Atmel:SAMD51_Drivers:0.0.1::SAMD51J19A-AF::RTC::driver_config_definition::Timer::HAL:Driver:Timer
   344	+    functionality: Timer
   345	+    api: HAL:Driver:Timer
   346	     configuration:
   347	-      usart_advanced: true
   348	-      usart_arch_clock_mode: USART with internal clock
   349	-      usart_arch_cloden: false
   350	-      usart_arch_dbgstop: Keep running
   351	-      usart_arch_dord: LSB is transmitted first
   352	-      usart_arch_enc: No encoding
   353	-      usart_arch_fractional: 0
   354	-      usart_arch_ibon: false
   355	-      usart_arch_lin_slave_enable: Disable
   356	-      usart_arch_runstdby: true
   357	-      usart_arch_sampa: 7-8-9 (3-4-5 8-bit over-sampling)
   358	-      usart_arch_sampr: 16x arithmetic
   359	-      usart_arch_sfde: false
   360	-      usart_baud_rate: 38400
   361	-      usart_character_size: 8 bits
   362	-      usart_parity: No parity
   363	-      usart_rx_enable: true
   364	-      usart_stop_bit: One stop bit
   365	-      usart_tx_enable: true
   366	+      rtc_arch_comp_val: 32
   367	+      rtc_arch_init_reset: true
   368	+      rtc_arch_prescaler: OFF(Peripheral clock divided by 1)
   369	+      rtc_cmpeo0: false
   370	+      rtc_cmpeo1: false
   371	+      rtc_event_control: false
   372	+      rtc_ovfeo: false
   373	+      rtc_pereo0: false
   374	+      rtc_pereo1: false
   375	+      rtc_pereo2: false
   376	+      rtc_pereo3: false
   377	+      rtc_pereo4: false
   378	+      rtc_pereo5: false
   379	+      rtc_pereo6: false
   380	+      rtc_pereo7: false
   381	+      rtc_tampereo: false
   382	+      rtc_tampevei: false
   383	     optional_signals: []
   384	-    variant:
   385	-      specification: TXPO=0, RXPO=1, CMODE=0
   386	-      required_signals:
   387	-      - name: SERCOM5/PAD/0
   388	-        pad: PB16
   389	-        label: TX
   390	-      - name: SERCOM5/PAD/1
   391	-        pad: PB17
   392	-        label: RX
   393	+    variant: null
   394	     clocks:
   395	       domain_group:
   396	         nodes:
   397	-        - name: Core
   398	-          input: Generic clock generator 0
   399	-        - name: Slow
   400	-          input: Generic clock generator 3
   401	+        - name: RTC
   402	+          input: RTC source
   403	         configuration:
   404	-          core_gclk_selection: Generic clock generator 0
   405	-          slow_gclk_selection: Generic clock generator 3
   406	+          rtc_clk_selection: RTC source
   407	   DELAY_0:
   408	     user_label: DELAY_0
   409	     definition: Atmel:SAMD51_Drivers:0.0.1::SAMD51J19A-AF::SysTick::driver_config_definition::Delay::HAL:Driver:Delay
   410	@@ -865,6 +852,64 @@ drivers:
   411	     variant: null
   412	     clocks:
   413	       domain_group: null
   414	+  TIMER_1:
   415	+    user_label: TIMER_1
   416	+    definition: Atmel:SAMD51_Drivers:0.0.1::SAMD51J19A-AF::TC0::driver_config_definition::Timer::HAL:Driver:Timer
   417	+    functionality: Timer
   418	+    api: HAL:Driver:Timer
   419	+    configuration:
   420	+      tc_arch_dbgrun: false
   421	+      tc_arch_evact: Event action disabled
   422	+      tc_arch_mceo0: false
   423	+      tc_arch_mceo1: false
   424	+      tc_arch_ondemand: false
   425	+      tc_arch_ovfeo: false
   426	+      tc_arch_presync: Reload or reset counter on next GCLK
   427	+      tc_arch_runstdby: false
   428	+      tc_arch_tcei: false
   429	+      tc_arch_tcinv: false
   430	+      timer_advanced_configuration: false
   431	+      timer_event_control: false
   432	+      timer_prescaler: Divide by 8
   433	+      timer_tick: 1000
   434	+    optional_signals: []
   435	+    variant: null
   436	+    clocks:
   437	+      domain_group:
   438	+        nodes:
   439	+        - name: TC
   440	+          input: Generic clock generator 1
   441	+        configuration:
   442	+          tc_gclk_selection: Generic clock generator 1
   443	+  TIMER_2:
   444	+    user_label: TIMER_2
   445	+    definition: Atmel:SAMD51_Drivers:0.0.1::SAMD51J19A-AF::TC1::driver_config_definition::Timer::HAL:Driver:Timer
   446	+    functionality: Timer
   447	+    api: HAL:Driver:Timer
   448	+    configuration:
   449	+      tc_arch_dbgrun: false
   450	+      tc_arch_evact: Event action disabled
   451	+      tc_arch_mceo0: false
   452	+      tc_arch_mceo1: false
   453	+      tc_arch_ondemand: false
   454	+      tc_arch_ovfeo: false
   455	+      tc_arch_presync: Reload or reset counter on next GCLK
   456	+      tc_arch_runstdby: false
   457	+      tc_arch_tcei: false
   458	+      tc_arch_tcinv: false
   459	+      timer_advanced_configuration: false
   460	+      timer_event_control: false
   461	+      timer_prescaler: Divide by 8
   462	+      timer_tick: 1000
   463	+    optional_signals: []
   464	+    variant: null
   465	+    clocks:
   466	+      domain_group:
   467	+        nodes:
   468	+        - name: TC
   469	+          input: Generic clock generator 1
   470	+        configuration:
   471	+          tc_gclk_selection: Generic clock generator 1
   472	 pads:
   473	   D4:
   474	     name: PA14
   475	@@ -888,15 +933,17 @@ pads:
   476	   PB16:
   477	     name: PB16
   478	     definition: Atmel:SAMD51_Drivers:0.0.1::SAMD51J19A-AF::pad::PB16
   479	-    mode: Peripheral IO
   480	+    mode: Digital output
   481	     user_label: PB16
   482	-    configuration: null
   483	+    configuration:
   484	+      pad_initial_level: High
   485	   PB17:
   486	     name: PB17
   487	     definition: Atmel:SAMD51_Drivers:0.0.1::SAMD51J19A-AF::pad::PB17
   488	-    mode: Peripheral IO
   489	+    mode: Digital input
   490	     user_label: PB17
   491	-    configuration: null
   492	+    configuration:
   493	+      pad_pull_config: Pull-up
   494	   D11:
   495	     name: PA21
   496	     definition: Atmel:SAMD51_Drivers:0.0.1::SAMD51J19A-AF::pad::PA21
   497	diff --git a/atmel_start_pins.h b/atmel_start_pins.h
   498	index 73313ac..78202f9 100644
   499	--- a/atmel_start_pins.h
   500	+++ b/atmel_start_pins.h
   501	@@ -28,12 +28,10 @@
   502	 #define GPIO_PIN_FUNCTION_N 13
   503	 
   504	 #define D4 GPIO(GPIO_PORTA, 14)
   505	-#define PA16 GPIO(GPIO_PORTA, 16) // on foreign target Metro M4 Express this is D13 - we are Feather M4 Express
   506	 #define D6 GPIO(GPIO_PORTA, 18)
   507	 #define D9 GPIO(GPIO_PORTA, 19)
   508	 #define D11 GPIO(GPIO_PORTA, 21)
   509	-#define PA23 GPIO(GPIO_PORTA, 23) // alias D13
   510	-#define D13 GPIO(GPIO_PORTA, 23) // alias PA23
   511	+#define D13 GPIO(GPIO_PORTA, 23)
   512	 #define PB03 GPIO(GPIO_PORTB, 3)
   513	 #define PB16 GPIO(GPIO_PORTB, 16)
   514	 #define PB17 GPIO(GPIO_PORTB, 17)
   515	diff --git a/config/hpl_gclk_config.h b/config/hpl_gclk_config.h
   516	index 8e4df18..70dbea1 100644
   517	--- a/config/hpl_gclk_config.h
   518	+++ b/config/hpl_gclk_config.h
   519	@@ -84,7 +84,7 @@
   520	 // <i> Indicates whether generic clock 1 configuration is enabled or not
   521	 // <id> enable_gclk_gen_1
   522	 #ifndef CONF_GCLK_GENERATOR_1_CONFIG
   523	-#define CONF_GCLK_GENERATOR_1_CONFIG 0
   524	+#define CONF_GCLK_GENERATOR_1_CONFIG 1
   525	 #endif
   526	 
   527	 // <h> Generic Clock Generator Control
   528	@@ -142,7 +142,7 @@
   529	 // <i> Indicates whether Generic Clock Generator Enable is enabled or not
   530	 // <id> gclk_arch_gen_1_enable
   531	 #ifndef CONF_GCLK_GEN_1_GENEN
   532	-#define CONF_GCLK_GEN_1_GENEN 0
   533	+#define CONF_GCLK_GEN_1_GENEN 1
   534	 #endif
   535	 // </h>
   536	 
   537	@@ -150,7 +150,7 @@
   538	 //<o> Generic clock generator 1 division <0x0000-0xFFFF>
   539	 // <id> gclk_gen_1_div
   540	 #ifndef CONF_GCLK_GEN_1_DIV
   541	-#define CONF_GCLK_GEN_1_DIV 1
   542	+#define CONF_GCLK_GEN_1_DIV 24
   543	 #endif
   544	 // </h>
   545	 // </e>
   546	@@ -252,14 +252,14 @@
   547	 // <i> This defines the clock source for generic clock generator 3
   548	 // <id> gclk_gen_3_oscillator
   549	 #ifndef CONF_GCLK_GEN_3_SOURCE
   550	-#define CONF_GCLK_GEN_3_SOURCE GCLK_GENCTRL_SRC_OSCULP32K
   551	+#define CONF_GCLK_GEN_3_SOURCE GCLK_GENCTRL_SRC_XOSC32K
   552	 #endif
   553	 
   554	 // <q> Run in Standby
   555	 // <i> Indicates whether Run in Standby is enabled or not
   556	 // <id> gclk_arch_gen_3_runstdby
   557	 #ifndef CONF_GCLK_GEN_3_RUNSTDBY
   558	-#define CONF_GCLK_GEN_3_RUNSTDBY 0
   559	+#define CONF_GCLK_GEN_3_RUNSTDBY 1
   560	 #endif
   561	 
   562	 // <q> Divide Selection
   563	@@ -287,7 +287,7 @@
   564	 // <i> Indicates whether Improve Duty Cycle is enabled or not
   565	 // <id> gclk_arch_gen_3_idc
   566	 #ifndef CONF_GCLK_GEN_3_IDC
   567	-#define CONF_GCLK_GEN_3_IDC 0
   568	+#define CONF_GCLK_GEN_3_IDC 1
   569	 #endif
   570	 
   571	 // <q> Generic Clock Generator Enable
   572	diff --git a/config/hpl_osc32kctrl_config.h b/config/hpl_osc32kctrl_config.h
   573	index 02e258a..6697e2a 100644
   574	--- a/config/hpl_osc32kctrl_config.h
   575	+++ b/config/hpl_osc32kctrl_config.h
   576	@@ -17,7 +17,7 @@
   577	 // <i> This defines the clock source for RTC
   578	 // <id> rtc_source_oscillator
   579	 #ifndef CONF_RTCCTRL_SRC
   580	-#define CONF_RTCCTRL_SRC GCLK_GENCTRL_SRC_OSCULP32K
   581	+#define CONF_RTCCTRL_SRC GCLK_GENCTRL_SRC_XOSC32K
   582	 #endif
   583	 
   584	 // <q> Use 1 kHz output
   585	@@ -43,7 +43,7 @@
   586	 // <i> Indicates whether configuration for External 32K Osc is enabled or not
   587	 // <id> enable_xosc32k
   588	 #ifndef CONF_XOSC32K_CONFIG
   589	-#define CONF_XOSC32K_CONFIG 0
   590	+#define CONF_XOSC32K_CONFIG 1
   591	 #endif
   592	 
   593	 // <h> 32kHz External Crystal Oscillator Control
   594	@@ -51,7 +51,7 @@
   595	 // <i> Indicates whether 32kHz External Crystal Oscillator is enabled or not
   596	 // <id> xosc32k_arch_enable
   597	 #ifndef CONF_XOSC32K_ENABLE
   598	-#define CONF_XOSC32K_ENABLE 0
   599	+#define CONF_XOSC32K_ENABLE 1
   600	 #endif
   601	 
   602	 // <o> Start-Up Time
   603	diff --git a/config/hpl_oscctrl_config.h b/config/hpl_oscctrl_config.h
   604	index 2ac9bd4..e69f867 100644
   605	--- a/config/hpl_oscctrl_config.h
   606	+++ b/config/hpl_oscctrl_config.h
   607	@@ -275,7 +275,7 @@
   608	 // <i> Indicates whether Run in Standby is enabled or not
   609	 // <id> dfll_arch_runstdby
   610	 #ifndef CONF_DFLL_RUNSTDBY
   611	-#define CONF_DFLL_RUNSTDBY 0
   612	+#define CONF_DFLL_RUNSTDBY 1
   613	 #endif
   614	 
   615	 // <q> USB Clock Recovery Mode
   616	@@ -324,7 +324,7 @@
   617	 // <i> Indicates whether Stable DFLL Frequency is enabled or not
   618	 // <id> dfll_arch_stable
   619	 #ifndef CONF_DFLL_STABLE
   620	-#define CONF_DFLL_STABLE 0
   621	+#define CONF_DFLL_STABLE 1
   622	 #endif
   623	 
   624	 // <o> Operating Mode Selection
   625	diff --git a/config/peripheral_clk_config.h b/config/peripheral_clk_config.h
   626	index f875616..3f54642 100644
   627	--- a/config/peripheral_clk_config.h
   628	+++ b/config/peripheral_clk_config.h
   629	@@ -12,8 +12,24 @@
   630	 #define CONF_CPU_FREQUENCY 48000000
   631	 #endif
   632	 
   633	-// <y> Core Clock Source
   634	-// <id> core_gclk_selection
   635	+// <y> RTC Clock Source
   636	+// <id> rtc_clk_selection
   637	+// <RTC_CLOCK_SOURCE"> RTC source
   638	+// <i> Select the clock source for RTC.
   639	+#ifndef CONF_GCLK_RTC_SRC
   640	+#define CONF_GCLK_RTC_SRC RTC_CLOCK_SOURCE
   641	+#endif
   642	+
   643	+/**
   644	+ * \def CONF_GCLK_RTC_FREQUENCY
   645	+ * \brief RTC's Clock frequency
   646	+ */
   647	+#ifndef CONF_GCLK_RTC_FREQUENCY
   648	+#define CONF_GCLK_RTC_FREQUENCY 32768
   649	+#endif
   650	+
   651	+// <y> TC Clock Source
   652	+// <id> tc_gclk_selection
   653	 
   654	 // <GCLK_PCHCTRL_GEN_GCLK0_Val"> Generic clock generator 0
   655	 
   656	@@ -39,13 +55,21 @@
   657	 
   658	 // <GCLK_PCHCTRL_GEN_GCLK11_Val"> Generic clock generator 11
   659	 
   660	-// <i> Select the clock source for CORE.
   661	-#ifndef CONF_GCLK_SERCOM5_CORE_SRC
   662	-#define CONF_GCLK_SERCOM5_CORE_SRC GCLK_PCHCTRL_GEN_GCLK0_Val
   663	+// <i> Select the clock source for TC.
   664	+#ifndef CONF_GCLK_TC0_SRC
   665	+#define CONF_GCLK_TC0_SRC GCLK_PCHCTRL_GEN_GCLK1_Val
   666	+#endif
   667	+
   668	+/**
   669	+ * \def CONF_GCLK_TC0_FREQUENCY
   670	+ * \brief TC0's Clock frequency
   671	+ */
   672	+#ifndef CONF_GCLK_TC0_FREQUENCY
   673	+#define CONF_GCLK_TC0_FREQUENCY 2000000
   674	 #endif
   675	 
   676	-// <y> Slow Clock Source
   677	-// <id> slow_gclk_selection
   678	+// <y> TC Clock Source
   679	+// <id> tc_gclk_selection
   680	 
   681	 // <GCLK_PCHCTRL_GEN_GCLK0_Val"> Generic clock generator 0
   682	 
   683	@@ -71,25 +95,17 @@
   684	 
   685	 // <GCLK_PCHCTRL_GEN_GCLK11_Val"> Generic clock generator 11
   686	 
   687	-// <i> Select the slow clock source.
   688	-#ifndef CONF_GCLK_SERCOM5_SLOW_SRC
   689	-#define CONF_GCLK_SERCOM5_SLOW_SRC GCLK_PCHCTRL_GEN_GCLK3_Val
   690	-#endif
   691	-
   692	-/**
   693	- * \def CONF_GCLK_SERCOM5_CORE_FREQUENCY
   694	- * \brief SERCOM5's Core Clock frequency
   695	- */
   696	-#ifndef CONF_GCLK_SERCOM5_CORE_FREQUENCY
   697	-#define CONF_GCLK_SERCOM5_CORE_FREQUENCY 48000000
   698	+// <i> Select the clock source for TC.
   699	+#ifndef CONF_GCLK_TC1_SRC
   700	+#define CONF_GCLK_TC1_SRC GCLK_PCHCTRL_GEN_GCLK1_Val
   701	 #endif
   702	 
   703	 /**
   704	- * \def CONF_GCLK_SERCOM5_SLOW_FREQUENCY
   705	- * \brief SERCOM5's Slow Clock frequency
   706	+ * \def CONF_GCLK_TC1_FREQUENCY
   707	+ * \brief TC1's Clock frequency
   708	  */
   709	-#ifndef CONF_GCLK_SERCOM5_SLOW_FREQUENCY
   710	-#define CONF_GCLK_SERCOM5_SLOW_FREQUENCY 32768
   711	+#ifndef CONF_GCLK_TC1_FREQUENCY
   712	+#define CONF_GCLK_TC1_FREQUENCY 2000000
   713	 #endif
   714	 
   715	 // <<< end of configuration section >>>
   716	diff --git a/gcc/Makefile b/gcc/Makefile
   717	index a35ea5e..69e858a 100644
   718	--- a/gcc/Makefile
   719	+++ b/gcc/Makefile
   720	@@ -27,19 +27,20 @@ endif
   721	 SUB_DIRS +=  \
   722	  \
   723	 hpl/pm \
   724	-gcc \
   725	+hpl/tc \
   726	 hpl/osc32kctrl \
   727	 hpl/ramecc \
   728	 hpl/dmac \
   729	 hal/src \
   730	+gcc \
   731	 hpl/mclk \
   732	 hpl/systick \
   733	 hal/utils/src \
   734	-hpl/sercom \
   735	 examples \
   736	 hpl/gclk \
   737	 hpl/oscctrl \
   738	 gcc/gcc \
   739	+hpl/rtc \
   740	 hpl/core
   741	 
   742	 # List the object files
   743	@@ -48,31 +49,30 @@ hal/src/hal_io.o \
   744	 hpl/systick/hpl_systick.o \
   745	 hpl/core/hpl_core_m4.o \
   746	 hal/utils/src/utils_syscalls.o \
   747	+hal/src/hal_timer.o \
   748	 hal/src/hal_delay.o \
   749	 hpl/oscctrl/hpl_oscctrl.o \
   750	 hpl/core/hpl_init.o \
   751	-hpl/gclk/hpl_gclk.o \
   752	+hpl/ramecc/hpl_ramecc.o \
   753	 hal/utils/src/utils_list.o \
   754	 gcc/system_samd51.o \
   755	 hal/utils/src/utils_assert.o \
   756	 hpl/dmac/hpl_dmac.o \
   757	 hpl/pm/hpl_pm.o \
   758	-hal/src/hal_usart_sync.o \
   759	 hpl/mclk/hpl_mclk.o \
   760	-hpl/ramecc/hpl_ramecc.o \
   761	+hpl/gclk/hpl_gclk.o \
   762	 hal/src/hal_init.o \
   763	 gcc/gcc/startup_samd51.o \
   764	 main.o \
   765	-gpio_local.o \
   766	-usart.o \
   767	 hpl/osc32kctrl/hpl_osc32kctrl.o \
   768	+hpl/rtc/hpl_rtc.o \
   769	 examples/driver_examples.o \
   770	 driver_init.o \
   771	-hpl/sercom/hpl_sercom.o \
   772	 hal/src/hal_gpio.o \
   773	 hal/utils/src/utils_event.o \
   774	 hal/src/hal_sleep.o \
   775	 atmel_start.o \
   776	+hpl/tc/hpl_tc.o \
   777	 hal/src/hal_atomic.o
   778	 
   779	 OBJS_AS_ARGS +=  \
   780	@@ -80,31 +80,30 @@ OBJS_AS_ARGS +=  \
   781	 "hpl/systick/hpl_systick.o" \
   782	 "hpl/core/hpl_core_m4.o" \
   783	 "hal/utils/src/utils_syscalls.o" \
   784	+"hal/src/hal_timer.o" \
   785	 "hal/src/hal_delay.o" \
   786	 "hpl/oscctrl/hpl_oscctrl.o" \
   787	 "hpl/core/hpl_init.o" \
   788	-"hpl/gclk/hpl_gclk.o" \
   789	+"hpl/ramecc/hpl_ramecc.o" \
   790	 "hal/utils/src/utils_list.o" \
   791	 "gcc/system_samd51.o" \
   792	 "hal/utils/src/utils_assert.o" \
   793	 "hpl/dmac/hpl_dmac.o" \
   794	 "hpl/pm/hpl_pm.o" \
   795	-"hal/src/hal_usart_sync.o" \
   796	 "hpl/mclk/hpl_mclk.o" \
   797	-"hpl/ramecc/hpl_ramecc.o" \
   798	+"hpl/gclk/hpl_gclk.o" \
   799	 "hal/src/hal_init.o" \
   800	 "gcc/gcc/startup_samd51.o" \
   801	 "main.o" \
   802	-"gpio_local.o" \
   803	-"usart.o" \
   804	 "hpl/osc32kctrl/hpl_osc32kctrl.o" \
   805	+"hpl/rtc/hpl_rtc.o" \
   806	 "examples/driver_examples.o" \
   807	 "driver_init.o" \
   808	-"hpl/sercom/hpl_sercom.o" \
   809	 "hal/src/hal_gpio.o" \
   810	 "hal/utils/src/utils_event.o" \
   811	 "hal/src/hal_sleep.o" \
   812	 "atmel_start.o" \
   813	+"hpl/tc/hpl_tc.o" \
   814	 "hal/src/hal_atomic.o"
   815	 
   816	 # List the dependency files
   817	@@ -117,6 +116,7 @@ DEPS_AS_ARGS +=  \
   818	 "hpl/systick/hpl_systick.d" \
   819	 "hpl/core/hpl_core_m4.d" \
   820	 "hal/utils/src/utils_syscalls.d" \
   821	+"hal/src/hal_timer.d" \
   822	 "gcc/system_samd51.d" \
   823	 "hal/utils/src/utils_list.d" \
   824	 "hpl/dmac/hpl_dmac.d" \
   825	@@ -127,18 +127,16 @@ DEPS_AS_ARGS +=  \
   826	 "hpl/gclk/hpl_gclk.d" \
   827	 "gcc/gcc/startup_samd51.d" \
   828	 "hal/src/hal_init.d" \
   829	-"hal/src/hal_usart_sync.d" \
   830	 "hpl/mclk/hpl_mclk.d" \
   831	 "driver_init.d" \
   832	 "hpl/osc32kctrl/hpl_osc32kctrl.d" \
   833	 "main.d" \
   834	-"gpio_local.d" \
   835	-"usart.d" \
   836	 "examples/driver_examples.d" \
   837	+"hpl/rtc/hpl_rtc.d" \
   838	 "hal/src/hal_sleep.d" \
   839	-"hpl/sercom/hpl_sercom.d" \
   840	 "hal/src/hal_gpio.d" \
   841	 "hal/src/hal_atomic.d" \
   842	+"hpl/tc/hpl_tc.d" \
   843	 "hpl/oscctrl/hpl_oscctrl.d" \
   844	 "atmel_start.d"
   845	 
   846	@@ -155,8 +153,6 @@ vpath %.S ../
   847	 all: $(SUB_DIRS) $(OUTPUT_FILE_PATH)
   848	 
   849	 # Linker target
   850	-# -T"../gcc/gcc/samd51j19a_flash_with_bootloader.ld" \
   851	-# -T"../gcc/gcc/samd51j19a_flash.ld" \
   852	 
   853	 $(OUTPUT_FILE_PATH): $(OBJS)
   854	 	@echo Building target: $@
   855	@@ -164,7 +160,7 @@ $(OUTPUT_FILE_PATH): $(OBJS)
   856	 	$(QUOTE)arm-none-eabi-gcc$(QUOTE) -o $(OUTPUT_FILE_NAME).elf $(OBJS_AS_ARGS) -Wl,--start-group -lm -Wl,--end-group -mthumb \
   857	 -Wl,-Map="$(OUTPUT_FILE_NAME).map" --specs=nano.specs -Wl,--gc-sections -mcpu=cortex-m4 \
   858	  \
   859	--T"../gcc/gcc/samd51j19a_flash_with_bootloader.ld" \
   860	+-T"../gcc/gcc/samd51j19a_flash.ld" \
   861	 -L"../gcc/gcc"
   862	 	@echo Finished building target: $@
   863	 
   864	@@ -189,7 +185,7 @@ $(OUTPUT_FILE_PATH): $(OBJS)
   865	 	@echo ARM/GNU C Compiler
   866	 	$(QUOTE)arm-none-eabi-gcc$(QUOTE) -x c -mthumb -DDEBUG -Os -ffunction-sections -mlong-calls -g3 -Wall -c -std=gnu99 \
   867	 -D__SAMD51J19A__ -mcpu=cortex-m4 -mfloat-abi=softfp -mfpu=fpv4-sp-d16 \
   868	--I"../" -I"../config" -I"../examples" -I"../hal/include" -I"../hal/utils/include" -I"../hpl/core" -I"../hpl/dmac" -I"../hpl/gclk" -I"../hpl/mclk" -I"../hpl/osc32kctrl" -I"../hpl/oscctrl" -I"../hpl/pm" -I"../hpl/port" -I"../hpl/ramecc" -I"../hpl/sercom" -I"../hpl/systick" -I"../hri" -I"../" -I"../CMSIS/Include" -I"../include"  \
   869	+-I"../" -I"../config" -I"../examples" -I"../hal/include" -I"../hal/utils/include" -I"../hpl/core" -I"../hpl/dmac" -I"../hpl/gclk" -I"../hpl/mclk" -I"../hpl/osc32kctrl" -I"../hpl/oscctrl" -I"../hpl/pm" -I"../hpl/port" -I"../hpl/ramecc" -I"../hpl/rtc" -I"../hpl/systick" -I"../hpl/tc" -I"../hri" -I"../" -I"../CMSIS/Include" -I"../include"  \
   870	 -MD -MP -MF "$(@:%.o=%.d)" -MT"$(@:%.o=%.d)" -MT"$(@:%.o=%.o)"  -o "$@" "$<"
   871	 	@echo Finished building: $<
   872	 
   873	@@ -198,7 +194,7 @@ $(OUTPUT_FILE_PATH): $(OBJS)
   874	 	@echo ARM/GNU Assembler
   875	 	$(QUOTE)arm-none-eabi-as$(QUOTE) -x c -mthumb -DDEBUG -Os -ffunction-sections -mlong-calls -g3 -Wall -c -std=gnu99 \
   876	 -D__SAMD51J19A__ -mcpu=cortex-m4 -mfloat-abi=softfp -mfpu=fpv4-sp-d16 \
   877	--I"../" -I"../config" -I"../examples" -I"../hal/include" -I"../hal/utils/include" -I"../hpl/core" -I"../hpl/dmac" -I"../hpl/gclk" -I"../hpl/mclk" -I"../hpl/osc32kctrl" -I"../hpl/oscctrl" -I"../hpl/pm" -I"../hpl/port" -I"../hpl/ramecc" -I"../hpl/sercom" -I"../hpl/systick" -I"../hri" -I"../" -I"../CMSIS/Include" -I"../include"  \
   878	+-I"../" -I"../config" -I"../examples" -I"../hal/include" -I"../hal/utils/include" -I"../hpl/core" -I"../hpl/dmac" -I"../hpl/gclk" -I"../hpl/mclk" -I"../hpl/osc32kctrl" -I"../hpl/oscctrl" -I"../hpl/pm" -I"../hpl/port" -I"../hpl/ramecc" -I"../hpl/rtc" -I"../hpl/systick" -I"../hpl/tc" -I"../hri" -I"../" -I"../CMSIS/Include" -I"../include"  \
   879	 -MD -MP -MF "$(@:%.o=%.d)" -MT"$(@:%.o=%.d)" -MT"$(@:%.o=%.o)"  -o "$@" "$<"
   880	 	@echo Finished building: $<
   881	 
   882	@@ -207,7 +203,7 @@ $(OUTPUT_FILE_PATH): $(OBJS)
   883	 	@echo ARM/GNU Preprocessing Assembler
   884	 	$(QUOTE)arm-none-eabi-gcc$(QUOTE) -x c -mthumb -DDEBUG -Os -ffunction-sections -mlong-calls -g3 -Wall -c -std=gnu99 \
   885	 -D__SAMD51J19A__ -mcpu=cortex-m4 -mfloat-abi=softfp -mfpu=fpv4-sp-d16 \
   886	--I"../" -I"../config" -I"../examples" -I"../hal/include" -I"../hal/utils/include" -I"../hpl/core" -I"../hpl/dmac" -I"../hpl/gclk" -I"../hpl/mclk" -I"../hpl/osc32kctrl" -I"../hpl/oscctrl" -I"../hpl/pm" -I"../hpl/port" -I"../hpl/ramecc" -I"../hpl/sercom" -I"../hpl/systick" -I"../hri" -I"../" -I"../CMSIS/Include" -I"../include"  \
   887	+-I"../" -I"../config" -I"../examples" -I"../hal/include" -I"../hal/utils/include" -I"../hpl/core" -I"../hpl/dmac" -I"../hpl/gclk" -I"../hpl/mclk" -I"../hpl/osc32kctrl" -I"../hpl/oscctrl" -I"../hpl/pm" -I"../hpl/port" -I"../hpl/ramecc" -I"../hpl/rtc" -I"../hpl/systick" -I"../hpl/tc" -I"../hri" -I"../" -I"../CMSIS/Include" -I"../include"  \
   888	 -MD -MP -MF "$(@:%.o=%.d)" -MT"$(@:%.o=%.d)" -MT"$(@:%.o=%.o)"  -o "$@" "$<"
   889	 	@echo Finished building: $<
   890	 
   891	@@ -221,41 +217,10 @@ endif
   892	 $(SUB_DIRS):
   893	 	$(MK_DIR) "$@"
   894	 
   895	-arc:
   896	-	# running target 'make arc' now
   897	-	cp   ./AtmelStart.bin    _stored/AtmelStart.bin
   898	-	cp   ./AtmelStart.eep    _stored/AtmelStart.eep
   899	-	cp   ./AtmelStart.elf    _stored/AtmelStart.elf
   900	-	cp   ./AtmelStart.hex    _stored/AtmelStart.hex
   901	-	cp   ./AtmelStart.lss    _stored/AtmelStart.lss
   902	-	cp   ./AtmelStart.map    _stored/AtmelStart.map
   903	-
   904	-# git checkout -- AtmelStart.bin
   905	-
   906	-checkout:
   907	-	# running target 'make checkout' now
   908	-	@git    checkout    --     _stored/AtmelStart.bin
   909	-	@git    checkout    --     _stored/AtmelStart.elf
   910	-	@git    checkout    --     _stored/AtmelStart.hex
   911	-	@git    checkout    --     _stored/AtmelStart.lss
   912	-	@git    checkout    --     _stored/AtmelStart.map
   913	-
   914	-#       @git    checkout    --     AtmelStart.eep
   915	-
   916	-# install: arc checkout
   917	-install: arc
   918	-	# running target 'make install' now
   919	-	./scripts/_bossac_local.sh ./AtmelStart.bin
   920	-	# use 'make checkout' to tell git no changes to AtmelStart.*
   921	-
   922	-
   923	-# for clean target:
   924	-# rm -f ./_stored/AtmelStart.???
   925	-
   926	 clean:
   927	 	rm -f $(OBJS_AS_ARGS)
   928	 	rm -f $(OUTPUT_FILE_PATH)
   929	 	rm -f $(DEPS_AS_ARGS)
   930	 	rm -f $(OUTPUT_FILE_NAME).a $(OUTPUT_FILE_NAME).hex $(OUTPUT_FILE_NAME).bin \
   931	         $(OUTPUT_FILE_NAME).lss $(OUTPUT_FILE_NAME).eep $(OUTPUT_FILE_NAME).map \
   932	-        $(OUTPUT_FILE_NAME).srec
   933	+        $(OUTPUT_FILE_NAME).srec
   934	\ No newline at end of file
   935	diff --git a/main.c b/main.c
   936	index 27cdebd..4652da4 100644
   937	--- a/main.c
   938	+++ b/main.c
   939	@@ -1,6 +1,11 @@
   940	-// Wed Aug  8 04:40:12 UTC 2018
   941	+#include <atmel_start.h>
   942	 
   943	-int main(void) {
   944	-    for (volatile int i=2; i>0; i--) {
   945	-    }
   946	+int main(void)
   947	+{
   948	+	/* Initializes MCU, drivers and middleware */
   949	+	atmel_start_init();
   950	+
   951	+	/* Replace with your application code */
   952	+	while (1) {
   953	+	}
   954	 }
 $ exit
exit

Script done on Wed 08 Aug 2018 05:03:29 AM UTC
